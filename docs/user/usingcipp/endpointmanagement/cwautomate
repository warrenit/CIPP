# Generate Token and Location ID using Script

## Find Location ID Number:

### ConnectWise Automate Thick Client:
- 1 Open CW automate Thick Client (Service Control Center) 
- 2 On the top right click on your Account Icon and go to preferences
- 3 In the preferences go make sure you show object IDs 
- 4 Take note of the LocationIDs number

### ConnectWise Automate Web Client:
- 1 Browse to the Location you wish to deploy to
- 2 Review the Web Address to find https://[yourautomateserverurl.tld]?siteid=[ID] you will require just the number where [ID] is

## Generate a Token:
Please import the following script https://forums.mspgeek.org/files/file/50-generate-agent-installertoken by following https://docs.connectwise.com/ConnectWise_Automate_Documentation/070/240/080

- 1 To generate a token it is easier to go to https://[yourautomateserverurl.tld]
- 2 Run the Generate Agent InstallerToken v2 script on a workstation
- 3 Press next, then fill in the details 
- 4 Please take note of the Parameter Variables:  as this explain on how to fill the values. Also this is the part where you fill in LocationID so the token relates to that LocationID
- 5 Then press run and you should receive an email in a few mins with the Token

## Deploy Automate as MSP App via CIPP
- 1 Go to https://[yourcippserverurl.tld]
- 2 In the sidebar, select Intune > Applications > Add MSP App
- 3 Select the relevant tenant
- 4 Select MSP Tool as CW Automate
- 5 Assign to all users and devices (or whatever assignment works for you)
- 6 Enter Intune Application Display Name you wish to use
- 7 Enter Automate Server (including HTTPS) as https://[yourcippserverurl.tld]
- 8 Enter Installer Token and Location ID generated by the script
- 9 Then you need to go to Intune > Applications > Application Queue and press the Deploy now button
